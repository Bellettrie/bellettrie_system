{% extends "base.html" %}
{% load item_detail_table %}
{% block title %}{{ object.get_title }}{% endblock %}
{% block content %}
    <div class="container-fluid" style="width:100%">
        <div class="row justify-content-md-center">
            {% include 'works/partials/work_table.html' %}
            {% with tbl=object.get_sub_works %}
                {% with series=object.workinseries_set.all %}
                    <div class="card col col-sm-12 col-xl-7">
                        <div class="card-body d-flex flex-column">
                            {% if series or perms.works.change_work %}
                                <h6>Series</h6><br>
                                <div>
                                    <table class="table table-striped" style="width: auto;">
                                        {% for series in  series %}
                                            {% include 'series/part_of_series_name.html' %}
                                        {% endfor %}
                                    </table>
                                </div>
                            {% endif %}
                            {% if tbl or perms.works.change_work %}
                                <h6>Subworks</h6><br>
                                {% with should_edit=1 %}
                                    {% if tbl %}
                                        {% include 'works/subwork_table.html' %}

                                    {% endif %}
                                {% endwith %}

                            {% endif %}
                            {% if perms.works.change_work %}

                                <a class="card-link"
                                   href="{% url 'work.subwork.new' object.pk %}">Add
                                    Subwork</a>
                            {% endif %}
                        </div>
                    </div>

                {% endwith %}
            {% endwith %}
            <div class="card col col-sm-12 col-xl-12">
                <div class="card-body d-flex flex-column">

                    <div class="card-title">Items for this publication</div>
                    <div>
                        {% detailed_items object.get_items request.user.member perms %}
                    </div>
                    {% if perms.works.change_item %}
                        <a href="{% url 'works.item.new' publication.pk %}" class="align-self-end card-link"
                           style="margin-top: auto;">Add new Item</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
